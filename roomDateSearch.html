<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover">
    <title>廬竣-空房查詢-</title>
    <!-- ---------------------CSS Reset--------------------- -->
    <link rel="stylesheet" href="css/cssReset.css">
    <!-- ---------------------共用--------------------- -->
    <link rel="stylesheet" href="css/globalCss.css">
    <script src="js/globalJs.js"></script>
    <link rel="stylesheet" href="css/roomDateSearch.css">
</head>
<body>
    <header>
        <nav>
            <a href="index.html">
                <img src="pic/logo.svg" alt="logo">
                <span>廬竣</span>
            </a>
            <ul>
                <li>
                    <a href="latestNews.html">最新消息</a>
                </li>
                <li>
                    <a href="room.html">民宿介紹</a>
                </li>
                <li> 
                    <a href="roomDateSearch.html">空房查詢</a>
                </li>
                <li>
                    <a href="notice.html">入住須知</a>
                </li>
            </ul>
            <a href="determinePage.html" class="btn">預定</a>
            <div class="hamburger">
                <span></span>
            </div>
        </nav>
    </header>
    <section>
        <div>
            <h2>空房日期</h2>
        </div>
        <article class="selectRoom">
            <div class="pic">
                <img src="pic/roomRefer_01.jpeg" alt="">
                <p>201房</p>
            </div>
            <article class="selectDate">
                <div class="date">
                    <table>
                        <caption><span class="leftBtn"></span><span id="year"></span>年<span id="month"></span>月<span class="rightBtn"></span></caption>
                        <thead>
                            <tr>
                                <td>日</td>
                                <td>一</td>
                                <td>二</td>
                                <td>三</td>
                                <td>四</td>
                                <td>五</td>
                                <td>六</td>
                            </tr>
                        </thead>
                        <tbody id="datestable">
                        </tbody>
                    </table>
                </div>
                
            </article>
            <a href="determinePage.html" class="btn">預定</a>
        </article>
   
        <article class="selectRoom">
            <div class="pic">
                <img src="pic/roomRefer_02.jpeg" alt="">
                <p>301房</p>
            </div>
            <article class="selectDate">
                <div class="date">
                    <table>
                        <caption><span class="leftBtn"></span><span id="year"></span>年<span id="month"></span>月<span class="rightBtn"></span></caption>
                        <thead>
                            <tr>
                                <td>日</td>
                                <td>一</td>
                                <td>二</td>
                                <td>三</td>
                                <td>四</td>
                                <td>五</td>
                                <td>六</td>
                            </tr>
                        </thead>
                        <tbody id="datestable">
                        </tbody>
                    </table>
                </div>
            </article>
            <a href="determinePage.html" class="btn">預定</a>
        </article>
        <article class="selectRoom">
            <div class="pic">
                <img src="pic/roomRefer_03.jpeg" alt="">
                <p>401房</p>
            </div>
            <article class="selectDate">
                <div class="date">
                    <table>
                        <caption><span class="leftBtn"></span><span id="year"></span>年<span id="month"></span>月<span class="rightBtn"></span></caption>
                        <thead>
                            <tr>
                                <td>日</td>
                                <td>一</td>
                                <td>二</td>
                                <td>三</td>
                                <td>四</td>
                                <td>五</td>
                                <td>六</td>
                            </tr>
                        </thead>
                        <tbody id="datestable">
                        </tbody>
                    </table>
                </div>
            </article>
            <a href="determinePage.html" class="btn">預定</a>
        </article>
    </section>
    <!-- ----------------頁尾---------------- -->
    
    <footer>
        <div class="footerLogo">
            <a href="#"><img src="pic/instagram.svg" alt="InstagramLogo"></a>
            <a href="#"><img src="pic/line.svg" alt="LineLogo" data-note="1111"></a>
            <a href="#"><img src="pic/facebook.svg" alt="FacebookLogo"></a>
            <a href="#"><img src="pic/youTube2.svg" alt="YoutubeLogo"></a>
        </div>
        <div class = "copyright">Copyright © 2022 CWjyun 僅供學習、展示用</div>
    </footer>



    <script>
        let selseDayArray = ['','']
        var yearSelect ;
        var monthSelect ;
        var datestable ;
        var nowdate;
        var rightBtn;
        var leftBtn;
        var month;
        var year;
        var selectday;
        
        //初始化
        window.addEventListener("load",function(){
            yearSelect = document.querySelectorAll('#year');
            monthSelect = document.querySelectorAll('#month');
            datestable = document.querySelectorAll('#datestable');
            rightBtn =  document.querySelectorAll('.rightBtn')
            leftBtn = document.querySelectorAll('.leftBtn')
           
            var nowdate = new Date();       //獲取當前的日期
            year = nowdate.getFullYear();
            month = nowdate.getMonth();
            showDatesInit();
                              //呼叫顯示日期的函式

            rightBtn.forEach( (e,index) => {
                e.addEventListener("click",function(){    
                    dateChange(1,index)
                    // document.write()
                });
            });
            leftBtn.forEach( (e,index) => {
                e.addEventListener("click",function(){    
                    dateChange(-1,index)
                });
            });
        })
        function dateChange(number,index){
            if((parseInt(monthSelect[index].innerHTML) + number) < 0){
                yearSelect[index].innerHTML =  parseInt(yearSelect[index].innerHTML) + number;
                monthSelect[index].innerHTML = 11
            }else if((month + number) > 11){
                yearSelect[index].innerHTML = parseInt(yearSelect[index].innerHTML) + number;
                monthSelect[index].innerHTML = 0
            }else{
                monthSelect[index].innerHTML = parseInt(monthSelect[index].innerHTML) + number;
            }
            showDates();
           
        }
        function selectBtnCreate(){
            selectday = document.querySelectorAll(".canAppointment")
            selectday.forEach( e => {
                e.addEventListener("click",()=>{
                    e.classList.add("selectday")
                    if(selseDayArray[0] == ''){
                        selseDayArray[0] = `${year}`+`${(month + 1)}`.padStart(2, '0')+`${(e.innerHTML)}`.padStart(2, '0')
                    }
                    if(/selectday/.text(e.classList)){
                        document.write('aaaaaa')
                    }
                });
            });
        }
      
      
        //獲取選擇的年月的第一天是星期幾 
        // function getDays(year,month){
        //     var d = new Date(year,month);
        //     return d.getDay();
        // }
        //改變月曆日期
        function showDatesInit(){
            yearSelect.forEach(e=>{
                e.innerHTML = year;
            });
            monthSelect.forEach(e=>{
                e.innerHTML = (`${month + 1}`).padStart(2, '0');
            });
            datestable.forEach(e=>{
                e.innerHTML =  "";
            });
            showDates();
        }
        function showDates(){
            datestable.forEach(e=>{
                e.innerHTML =  "";
            });
            yearSelect.forEach((e,index)=>{
                yearsm = parseInt(e.innerHTML);
                monthsm = parseInt(monthSelect[index].innerHTML);
                nullnumber = new Date(yearsm,monthsm - 1).getDay();
                allnumber = nullnumber + new Date(yearsm,monthsm,0).getDate() ; //算出這月星期過開使+算出這個月有幾天

                var tr = document.createElement('tr');
                for(var k = 1; k <= allnumber ;k++){
                    tr.appendChild(createTd((k <= nullnumber) ?  "":(k - nullnumber) ));
                    if(k != 0 && k%7 == 0){
                        datestable[index].appendChild(tr)
                        tr = document.createElement('tr')
                    } 
                }
                datestable[index].appendChild(tr)
                selectBtnCreate()
            })
        }
        //建立td並新增至對應的容器
        function createTd(text){
            var td = document.createElement('td');
            var span = document.createElement('span');
            span.innerHTML = text;
            td.append(span)
            if(text != ""){
                td.classList.add("canAppointment")
            }
            return td;
        }

        </script>
    
</body>
</html>